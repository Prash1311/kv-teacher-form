<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KV Contractual Teacher Application</title>

<style>
body{font-family:Arial,Helvetica,sans-serif;background:#eef2f5;margin:0}
.container{background:white;max-width:900px;margin:auto;padding:15px}
h2,h3{text-align:center;margin:6px}
label{font-weight:600}
input,select,textarea{
  width:100%;padding:10px;margin:6px 0;
  border:1px solid #bbb;border-radius:6px;
  font-size:15px;box-sizing:border-box
}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #444;padding:6px;font-size:14px;text-align:center}
button{
  background:#0b6efd;color:white;border:none;
  padding:12px;border-radius:8px;width:100%;
  font-size:16px;margin-top:12px;cursor:pointer
}
button.small{width:auto;padding:6px 10px;margin:3px}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
@media(max-width:700px){.grid{grid-template-columns:1fr}}
.photoBox{border:2px dashed #666;padding:15px;text-align:center;border-radius:10px}
.error{color:red;margin-top:10px}
.success{color:green;margin-top:10px}
</style>
</head>

<body>
<div class="container">

<h2>KENDRIYA VIDYALAYA K R PURAM</h2>
<h3>PART-TIME CONTRACTUAL TEACHERS FORM</h3>

<div class="grid">
<div>
<label>Post Applied For *</label>
<select id="postApplied">
<option value="">Select</option>
<option>PRT</option>
<option>TGT</option>
<option>PGT</option>
<option>Computer Instructor</option>
<option>Other</option>
</select>
</div>

<div>
<label>Subject *</label>
<input id="subjectInput" type="text">
</div>
</div>

<h3>Personal Details</h3>

<div class="grid">
<div>
<label>Full Name *</label>
<input id="name" type="text">
</div>
<div>
<label>Father/Husband Name</label>
<input type="text">
</div>
</div>

<div class="grid">
<div>
<label>Date of Birth *</label>
<input id="dob" type="date">
</div>
<div>
<label>Gender</label>
<select>
<option>Male</option>
<option>Female</option>
<option>Other</option>
</select>
</div>
</div>

<div class="grid">
<div>
<label>Mobile *</label>
<input id="mobile" type="tel" maxlength="10">
</div>
<div>
<label>Email *</label>
<input id="email" type="email">
</div>
</div>

<label>Address *</label>
<textarea id="address" rows="2"></textarea>

<div class="photoBox">
<b>Take Selfie</b><br>
<input type="file" accept="image/*" capture="user">
</div>

<h3>Teaching Experience</h3>
<table id="exp">
<tr>
<th>Post</th>
<th>Subject</th>
<th>Institution</th>
<th>Board</th>
<th>From</th>
<th>To</th>
<th>Remove</th>
</tr>
</table>

<button type="button" onclick="addRow()">Add Experience</button>

<button id="submitForm">Submit Application</button>

<div id="message"></div>

</div>

<script>
function addRow(){
let t=document.getElementById('exp');
let r=t.insertRow(-1);
r.innerHTML=`
<td><select><option>PGT</option><option>TGT</option><option>PRT</option></select></td>
<td><input></td>
<td><input></td>
<td><select><option>CBSE</option><option>State</option><option>ICSE</option></select></td>
<td><input type="date"></td>
<td><input type="date"></td>
<td><button class='small' onclick="this.closest('tr').remove()">X</button></td>`;
}

document.getElementById("submitForm").addEventListener("click", async function(e){
    e.preventDefault();

    const msg = document.getElementById("message");
    msg.innerHTML = "";

    const name = document.getElementById("name").value.trim();
    const mobile = document.getElementById("mobile").value.trim();
    const email = document.getElementById("email").value.trim();
    const dob = document.getElementById("dob").value;
    const post = document.getElementById("postApplied").value;
    const subject = document.getElementById("subjectInput").value.trim();
    const address = document.getElementById("address").value.trim();

    if(!name || !mobile || !email || !dob || !post || !subject || !address){
        msg.innerHTML = "<div class='error'>Please fill all required fields.</div>";
        return;
    }

    if(!/^[0-9]{10}$/.test(mobile)){
        msg.innerHTML = "<div class='error'>Mobile number must be 10 digits.</div>";
        return;
    }

    const data = {
        Name: name,
        Email: email,
        Mobile: mobile,
        "Date of Birth": dob,
        "Post Applied For": post,
        Subject: subject,
        Address: address
    };

    try{
        const res = await fetch("https://script.google.com/macros/s/AKfycbztgC1UwbByGOm4EEUJeDNqhB5JtOQmid7lbW5UAHJY91GFtyJ-iXNasPKzg-59epen/exec",{
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify(data)
        });

        const result = await res.json();

        if(result.status === "saved"){
            msg.innerHTML = "<div class='success'>Application Submitted Successfully! Registration No: " + result.registration + "</div>";
        } else {
            msg.innerHTML = "<div class='error'>Error: " + result.message + "</div>";
        }

    }catch(err){
        msg.innerHTML = "<div class='error'>Submission failed. Open via GitHub Pages or Live Server.</div>";
    }
});
</script>

</body>
</html>
